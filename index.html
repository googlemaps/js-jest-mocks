<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@googlemaps/jest-mocks</title><meta name="description" content="Documentation for @googlemaps/jest-mocks"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@googlemaps/jest-mocks</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@googlemaps/jest-mocks</h1></div><div class="tsd-panel tsd-typography"><p><a href="https://npmjs.com/package/@googlemaps/jest-mocks"><img src="https://img.shields.io/npm/v/@googlemaps/jest-mocks" alt="npm"></a>
<img src="https://github.com/googlemaps/js-jest-mocks/workflows/Release/badge.svg" alt="Release">
<img src="https://img.shields.io/badge/stability-stable-green" alt="Stable">
<a href="https://github.com/googlemaps/js-jest-mocks/actions/workflows/test.yml"><img src="https://github.com/googlemaps/js-jest-mocks/actions/workflows/test.yml/badge.svg" alt="Tests/Build"></a></p>
<p><a href="https://codecov.io/gh/googlemaps/js-jest-mocks"><img src="https://codecov.io/gh/googlemaps/js-jest-mocks/branch/main/graph/badge.svg" alt="codecov"></a>
<a href="https://github.com/semantic-release/semantic-release"><img src="https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg" alt="semantic-release"></a>
<a href="https://github.com/apps/in-solidarity"><img src="https://github.com/jpoehnelt/in-solidarity-bot/raw/main/static//badge-flat.png" alt="solidarity"></a></p>
<p><img src="https://img.shields.io/github/contributors/googlemaps/js-jest-mocks?color=green" alt="Contributors">
<a href="media/LICENSE"><img src="https://img.shields.io/github/license/googlemaps/js-jest-mocks?color=blue" alt="License"></a>
<a href="https://stackoverflow.com/questions/tagged/google-maps"><img src="https://img.shields.io/stackexchange/stackoverflow/t/google-maps?color=orange&amp;label=google-maps&amp;logo=stackoverflow" alt="StackOverflow"></a>
<a href="https://discord.gg/hYsWbmk"><img src="https://img.shields.io/discord/676948200904589322?color=6A7EC2&amp;logo=discord&amp;logoColor=ffffff" alt="Discord"></a></p>
<a id="jest-mocks-for-google-maps" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Jest Mocks for Google Maps<a href="#jest-mocks-for-google-maps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="description" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Description<a href="#description" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Jest mocks for Google Maps in TypeScript.</p>
<p><strong>Note:</strong> If you find a missing mock, please <a href="https://github.com/googlemaps/js-jest-mocks/issues/new/choose">file an issue</a>.</p>
<a id="requirements" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Requirements<a href="#requirements" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://console.cloud.google.com/google/maps-apis/start">Sign up with Google Maps Platform</a></li>
<li>A Google Maps Platform <a href="https://developers.google.com/maps/documentation/javascript/cloud-setup#enabling-apis">project</a> with the <a href="https://developers.google.com/maps/documentation/javascript"><strong>Maps Javascript API</strong></a> enabled</li>
<li>An <a href="https://developers.google.com/maps/documentation/javascript/get-api-key">API key</a> associated with the project above</li>
<li>Node.js and NPM</li>
</ul>
<a id="installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Available via NPM as the package <code>@googlemaps/jest-mocks</code></p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1"> @</span><span class="hl-0">googlemaps</span><span class="hl-1">/</span><span class="hl-0">jest</span><span class="hl-1">-</span><span class="hl-0">mocks</span>
</code><button>Copy</button></pre>

<a id="usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>These mocks need the tests to run in a browser-like environment (for example
<code>jest-environment-jsdom</code>).</p>
<p>Before running the tests, you have to call the exported <code>initialize</code>
function to set up the global namespaces of the mocked Google Maps API:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">initialize</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@googlemaps/jest-mocks&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">initialize</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>You can then run the test-code that makes use of the Maps API almost as normal.
&quot;Almost&quot; is referring to the fact that the objects are all non-functional and
some things you can do with the real maps API cannot be done with the mocks
library.</p>
<p>We also export the <code>mockInstances</code> object and mocked constructors of all
classes (e.g. <code>Map</code> or <code>Marker</code>) that can be used to retrieve, inspect and
configure the mocks.</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">initialize</span><span class="hl-1">, </span><span class="hl-0">Map</span><span class="hl-1">, </span><span class="hl-0">Marker</span><span class="hl-1">, </span><span class="hl-0">mockInstances</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@googlemaps/jest-mocks&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">// this represents your code being tested</span><br/><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-4">codeUnderTest</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">map</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-4">Map</span><span class="hl-1">(</span><span class="hl-5">null</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">markerOne</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-4">Marker</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">markerTwo</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-4">Marker</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-0">map</span><span class="hl-1">.</span><span class="hl-4">setHeading</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">markerOne</span><span class="hl-1">.</span><span class="hl-4">setMap</span><span class="hl-1">(</span><span class="hl-0">map</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">markerTwo</span><span class="hl-1">.</span><span class="hl-4">setLabel</span><span class="hl-1">(</span><span class="hl-3">&quot;My marker&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">initialize</span><span class="hl-1">();</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;my test&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">codeUnderTest</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// mockInstances stores the lists of all maps-objects created since</span><br/><span class="hl-1">  </span><span class="hl-6">// `initialize` was called, organized by constructor.</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">mapMocks</span><span class="hl-1"> = </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-0">Map</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">markerMocks</span><span class="hl-1"> = </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-0">Marker</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">mapMocks</span><span class="hl-1">).</span><span class="hl-4">toHaveLength</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">markerMocks</span><span class="hl-1">).</span><span class="hl-4">toHaveLength</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">mapMocks</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">].</span><span class="hl-0">setHeading</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalledWith</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">markerMocks</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">].</span><span class="hl-0">setMap</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalledTimes</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">markerMocks</span><span class="hl-1">[</span><span class="hl-8">1</span><span class="hl-1">].</span><span class="hl-0">setLabel</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalledWith</span><span class="hl-1">(</span><span class="hl-3">&quot;My marker&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// note that this will not work (`map.setHeading(8)` will not update any</span><br/><span class="hl-1">  </span><span class="hl-6">// internal state of the map):</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">mapMocks</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">].</span><span class="hl-4">getHeading</span><span class="hl-1">()).</span><span class="hl-4">toBe</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="testing-events" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Testing Events<a href="#testing-events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To test code that uses events dispatched by Maps API objects, you can
follow a pattern like this:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">mockInstances</span><span class="hl-1">, </span><span class="hl-0">Map</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;./registry&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-0">eventTriggered</span><span class="hl-1"> = </span><span class="hl-5">false</span><span class="hl-1">;</span><br/><br/><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-4">codeUnderTest</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">map</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-4">Map</span><span class="hl-1">(</span><span class="hl-5">null</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">listener</span><span class="hl-1"> = </span><span class="hl-0">map</span><span class="hl-1">.</span><span class="hl-4">addListener</span><span class="hl-1">(</span><span class="hl-3">&quot;bounds_changed&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// whatever happens here should be observeable in some way, for the</span><br/><span class="hl-1">    </span><span class="hl-6">// sake of this example, we just set a global variable:</span><br/><span class="hl-1">    </span><span class="hl-0">eventTriggered</span><span class="hl-1"> = </span><span class="hl-5">true</span><span class="hl-1">;</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;testing events&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// run the code under test, which will register an event-listener</span><br/><span class="hl-1">  </span><span class="hl-4">codeUnderTest</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// since `map.addListener` doesn&#39;t actually do anything, we&#39;ll have to</span><br/><span class="hl-1">  </span><span class="hl-6">// retrieve the event-handler function and trigger the event ourselves</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">map</span><span class="hl-1">: </span><span class="hl-9">google</span><span class="hl-1">.</span><span class="hl-9">maps</span><span class="hl-1">.</span><span class="hl-9">Map</span><span class="hl-1"> = </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-0">Map</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">addListener</span><span class="hl-1">: </span><span class="hl-9">jest</span><span class="hl-1">.</span><span class="hl-9">MockedFunction</span><span class="hl-1">&lt;</span><span class="hl-5">typeof</span><span class="hl-1"> </span><span class="hl-0">map</span><span class="hl-1">.</span><span class="hl-0">addListener</span><span class="hl-1">&gt; =</span><br/><span class="hl-1">    </span><span class="hl-0">map</span><span class="hl-1">.</span><span class="hl-0">addListener</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">addListener</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalledTimes</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> [</span><span class="hl-7">eventType</span><span class="hl-1">, </span><span class="hl-7">listener</span><span class="hl-1">] = </span><span class="hl-0">addListener</span><span class="hl-1">.</span><span class="hl-0">mock</span><span class="hl-1">.</span><span class="hl-0">lastCall</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// call the listener function (for mouse-events you&#39;d have to create the</span><br/><span class="hl-1">  </span><span class="hl-6">// event-object here as well)</span><br/><span class="hl-1">  </span><span class="hl-4">listener</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// assert that whatever the effect of your code receiving the event happened</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">eventTriggered</span><span class="hl-1">).</span><span class="hl-4">toBe</span><span class="hl-1">(</span><span class="hl-5">true</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="extending-mocks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Extending Mocks<a href="#extending-mocks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>There are situations where you need some more functionality from the mocks
than what is provided by this library. In these cases, you can extend the
existing mocks.</p>
<p>For example, if you want to observe the creation of a Map instance to
validate constructor-arguments, you can add a spy function like this:</p>
<pre><code class="ts"><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-0">createMapSpy</span><span class="hl-1">: </span><span class="hl-9">jest</span><span class="hl-1">.</span><span class="hl-9">Mock</span><span class="hl-1">&lt;</span><br/><span class="hl-1">  </span><span class="hl-9">void</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-9">ConstructorParameters</span><span class="hl-1">&lt;</span><span class="hl-5">typeof</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-0">Map</span><span class="hl-1">&gt;</span><br/><span class="hl-1">&gt;;</span><br/><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">initialize</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-0">createMapSpy</span><span class="hl-1"> = </span><span class="hl-0">jest</span><span class="hl-1">.</span><span class="hl-4">fn</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// overwrite the mock implementation with an anonymous class</span><br/><span class="hl-1">  </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-0">Map</span><span class="hl-1"> = </span><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-9">google</span><span class="hl-1">.</span><span class="hl-9">maps</span><span class="hl-1">.</span><span class="hl-9">Map</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">constructor</span><span class="hl-1">(...</span><span class="hl-0">args</span><span class="hl-1">: </span><span class="hl-9">ConstructorParameters</span><span class="hl-1">&lt;</span><span class="hl-5">typeof</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-0">Map</span><span class="hl-1">&gt;) {</span><br/><span class="hl-1">      </span><span class="hl-4">createMapSpy</span><span class="hl-1">(...</span><span class="hl-0">args</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">super</span><span class="hl-1">(...</span><span class="hl-0">args</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;map constructor&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">mapOptions</span><span class="hl-1"> = { </span><span class="hl-0">mapId:</span><span class="hl-1"> </span><span class="hl-3">&quot;abcd&quot;</span><span class="hl-1"> };</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">map</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-4">Map</span><span class="hl-1">(</span><span class="hl-5">null</span><span class="hl-1">, </span><span class="hl-0">mapOptions</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">createMapSpy</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalledWith</span><span class="hl-1">(</span><span class="hl-5">null</span><span class="hl-1">, </span><span class="hl-0">mapOptions</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>So essentially, you can overwrite the classes in the global <code>google.maps</code>
namespace with your own classes extending the existing ones. The <code>initialize</code>
function will always restore them to their initial state.</p>
<a id="mocking-services" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Mocking Services<a href="#mocking-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If your code is interacting with services provided by the Maps API, you can
control the results that will be returned when calling the methods of the
service. First you need to get the service instance that was created by
your code using the <code>mockInstances</code> registry:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">initialize</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">AutocompleteService</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">mockInstances</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@googlemaps/jest-mocks&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">initialize</span><span class="hl-1">();</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;...&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// [... do something that creates a google.maps.AutocompleteService instance]</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> [</span><span class="hl-7">serviceMock</span><span class="hl-1">] = </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-0">AutocompleteService</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">expect</span><span class="hl-1">(</span><span class="hl-0">serviceMock</span><span class="hl-1">.</span><span class="hl-0">getPlacePredictions</span><span class="hl-1">).</span><span class="hl-4">toHaveBeenCalled</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Note that the imported <code>AutocompleteService</code> and
<code>google.maps.places.AutocompleteService</code> are the same object.
The only difference is that the former one is known to be the mocked version
(so you can access the mock-interface without type-errors when writing tests
in TS.</p>
<p>Since the mocked methods are created in the constructor of the mocked
<code>AutocompleteService</code>, we can't overwrite the behavior of the methods before
the constructor has been called.</p>
<p>If the creation of the AutocompleteService is separated from it's usage,
this is relatively easy:</p>
<pre><code class="ts"><span class="hl-6">// assuming your class under test looks like this:</span><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-9">MyAutocomplete</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">service</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-0">places</span><span class="hl-1">.</span><span class="hl-4">AutocompleteService</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-4">update</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">res</span><span class="hl-1"> = </span><span class="hl-2">await</span><span class="hl-1"> </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">service</span><span class="hl-1">.</span><span class="hl-4">getPlacePredictions</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">// configure the mocks after the constructor has been called:</span><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;...&quot;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">subject</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">MyAutocomplete</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> [</span><span class="hl-7">serviceMock</span><span class="hl-1">] = </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-0">AutocompleteService</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">serviceMock</span><span class="hl-1">.</span><span class="hl-0">getPlacePredictions</span><span class="hl-1">.</span><span class="hl-4">mockImplementation</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">// whatever you want the return-value to be</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// now call the method under test</span><br/><span class="hl-1">  </span><span class="hl-2">await</span><span class="hl-1"> </span><span class="hl-0">subject</span><span class="hl-1">.</span><span class="hl-4">update</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// validate the outcome</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The same applies if you can somehow separate the creation of the service-object
from its usage, for example, by monkey-patching it in the tests:</p>
<pre><code class="ts"><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;...&quot;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">subject</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">MyAutocomplete</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// this is assuming that `subject.update()` will internally call a method</span><br/><span class="hl-1">  </span><span class="hl-6">// `this.createAutocompleteService()` when called.</span><br/><span class="hl-1">  </span><span class="hl-0">subject</span><span class="hl-1">.</span><span class="hl-0">createAutocompleteService</span><span class="hl-1"> = </span><span class="hl-0">jest</span><span class="hl-1">.</span><span class="hl-4">fn</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">svc</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-4">AutocompleteService</span><span class="hl-1">();</span><br/><br/><span class="hl-1">    </span><span class="hl-6">// configure mocked methods as above</span><br/><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-0">svc</span><span class="hl-1">;</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-2">await</span><span class="hl-1"> </span><span class="hl-0">subject</span><span class="hl-1">.</span><span class="hl-4">update</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Both of these solutions are probably more of an antipattern, since they
expose implementation details (like the <code>service</code> property or the
<code>createAutocompleteService</code> method) to the test, making it harder to change
the implementation without updating the test.</p>
<p>The recommended way is to achieve this is to replace the <code>AutocompleteService</code>
class entirely to get full control over its behavior in your tests:</p>
<pre><code class="ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-7">getPlacePredictionsMock</span><span class="hl-1"> = </span><span class="hl-0">jest</span><span class="hl-1">.</span><span class="hl-4">fn</span><span class="hl-1">();</span><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-9">MockAutocompleteService</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-9">AutocompleteService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">super</span><span class="hl-1">();</span><br/><br/><span class="hl-1">    </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">getPlacePredictions</span><span class="hl-1"> = </span><span class="hl-0">getPlacePredictionsMock</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">test</span><span class="hl-1">(</span><span class="hl-3">&quot;...&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">google</span><span class="hl-1">.</span><span class="hl-0">maps</span><span class="hl-1">.</span><span class="hl-0">places</span><span class="hl-1">.</span><span class="hl-0">AutocompleteService</span><span class="hl-1"> = </span><span class="hl-0">MockAutocompleteService</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">getPlacePredictions</span><span class="hl-1">.</span><span class="hl-4">mockImplementation</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">return</span><span class="hl-1"> { ... };</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// run your test</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="cleaning-up-mocks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Cleaning up mocks<a href="#cleaning-up-mocks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Whenever <code>initialize()</code> is called, the captured mocks are automatically cleaned. Using any of Jest's methods, you can clean the mock instances at any time:</p>
<pre><code class="ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">initialize</span><span class="hl-1">, </span><span class="hl-0">Map</span><span class="hl-1">, </span><span class="hl-0">Marker</span><span class="hl-1">, </span><span class="hl-0">mockInstances</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@googlemaps/jest-mocks&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">beforeAll</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">initialize</span><span class="hl-1">();</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">// Clear all mocks</span><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">clearAll</span><span class="hl-1">();</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">// Clear specific mocks</span><br/><span class="hl-4">beforeEach</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">mockInstances</span><span class="hl-1">.</span><span class="hl-4">clear</span><span class="hl-1">(</span><span class="hl-0">Map</span><span class="hl-1">, </span><span class="hl-0">Marker</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Contributions are welcome and encouraged! If you'd like to contribute, send us a <a href="https://github.com/googlemaps/js-jest-mocks/compare">pull request</a> and refer to our <a href="?tab=coc-ov-file#readme">code of conduct</a> and <a href="media/CONTRIBUTING.md">contributing guide</a>.</p>
<a id="terms-of-service" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Terms of Service<a href="#terms-of-service" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This library uses Google Maps Platform services. Use of Google Maps Platform services through this library is subject to the Google Maps Platform <a href="https://cloud.google.com/maps-platform/terms">Terms of Service</a>.</p>
<p>This library is not a Google Maps Platform Core Service. Therefore, the Google Maps Platform Terms of Service (e.g. Technical Support Services, Service Level Agreements, and Deprecation Policy) do not apply to the code in this library.</p>
<a id="support" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Support<a href="#support" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This library is offered via an open source <a href="media/LICENSE">license</a>. It is not governed by the Google Maps Platform Support [Technical Support Services Guidelines, the SLA, or the <a href="https://cloud.google.com/maps-platform/terms">Deprecation Policy</a>. However, any Google Maps Platform services used by the library remain subject to the Google Maps Platform Terms of Service.</p>
<p>This library adheres to <a href="https://semver.org">semantic versioning</a> to indicate when backwards-incompatible changes are introduced. Accordingly, while the library is in version 0.x, backwards-incompatible changes may be introduced at any time.</p>
<p>If you find a bug, or have a feature request, please <a href="https://github.com/googlemaps/js-jest-mocks/issues/new/choose">file an issue</a> on GitHub. If you would like to get answers to technical questions from other Google Maps Platform developers, ask through one of our <a href="https://developers.google.com/maps/developer-community">developer community channels</a>. If you'd like to contribute, please check the <a href="media/CONTRIBUTING.md">contributing guide</a>.</p>
<p>You can also discuss this library on our <a href="https://discord.gg/hYsWbmk">Discord server</a>.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#jest-mocks-for-google-maps"><span>Jest <wbr/>Mocks for <wbr/>Google <wbr/>Maps</span></a><ul><li><a href="#description"><span>Description</span></a></li><li><a href="#requirements"><span>Requirements</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#usage"><span>Usage</span></a></li><li><ul><li><a href="#testing-events"><span>Testing <wbr/>Events</span></a></li><li><a href="#extending-mocks"><span>Extending <wbr/>Mocks</span></a></li><li><a href="#mocking-services"><span>Mocking <wbr/>Services</span></a></li><li><a href="#cleaning-up-mocks"><span>Cleaning up mocks</span></a></li></ul></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#terms-of-service"><span>Terms of <wbr/>Service</span></a></li><li><a href="#support"><span>Support</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">@googlemaps/jest-mocks</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
